<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ev="http://www.w3.org/2001/xml-events"
      xmlns:bf="http://betterform.sourceforge.net/xforms"
      xmlns:xsd="http://www.w3.org/2001/XMLSchema"
      xmlns:vra="http://www.vraweb.org/vracore4.htm"
      xmlns:bfc="http://betterform.sourceforge.net/xforms/controls"
      xmlns:xf="http://www.w3.org/2002/xforms"
      xmlns:xi="http://www.w3.org/2001/XInclude">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>Ziziphus_Image_DB</title>
    </head>
    <body>
        <div id="xforms">
            <!-- ###################### MODEL ################################## -->
            <!-- ###################### MODEL ################################## -->
            <!-- ###################### MODEL ################################## -->
            <div style="display:none">
                <xf:model id="m-child-model" schema="resources/xsd/vra-types.xsd">
                    <xf:instance id="i-agentSet">
                        <agentSet xmlns="http://www.vraweb.org/vracore4.htm">
                            <display dataDate="" extent="" href="" xml:lang="" pref="false" refid="" rules="" source="" vocab="" script=""
                                     transliteration=""/>
                            <notes dataDate="" extent="" href="" xml:lang="" pref="false" refid="" rules="" source="" vocab="" script=""
                                   transliteration=""/>
                            <agent dataDate="" extent="" href="" xml:lang="" pref="false" refid="" rules="" source="" vocab="" script=""
                                   transliteration="">
                                <attribution dataDate="" extent="" href="" xml:lang="" pref="false" refid="" rules="" source="" vocab=""
                                             script="" transliteration=""/>
                                <culture dataDate="" extent="" href="" xml:lang="" pref="false" refid="" rules="" source="" vocab=""
                                         script="" transliteration=""/>
                                <dates type="">
                                    <earliestDate circa="false"/>
                                    <latestDate circa="false"/>
                                </dates>
                                <name type="" dataDate="" extent="" href="" xml:lang="" pref="false" refid="" rules="" source="" vocab=""
                                      script="" transliteration=""/>
                                <role dataDate="" extent="" href="" xml:lang="" pref="false" refid="" rules="" source="" vocab="" script=""
                                      transliteration=""/>
                            </agent>
                        </agentSet>
                    </xf:instance>
                    <xf:bind nodeset="instance()">
                        <!--
                            <xf:bind nodeset="vra:display">
                                <xf:bind nodeset="@dataDate" type="vra:dateValueType"/>
                                <xf:bind nodeset="@extent"/>
                                <xf:bind nodeset="@href" type="xsd:anyURI"/>
                                <xf:bind nodeset="@xml:lang"/>
                                <xf:bind nodeset="@pref" type="xsd:boolean"/>
                                <xf:bind nodeset="@refid"/>
                                <xf:bind nodeset="@rules"/>
                                <xf:bind nodeset="@source"/>
                                <xf:bind nodeset="@vocab"/>
                            </xf:bind>
                        -->
                        <xf:bind nodeset="vra:notes">
                            <!--
                                <xf:bind nodeset="@dataDate" type="vra:dateValueType"/>
                                <xf:bind nodeset="@extent"/>
                                <xf:bind nodeset="@href" type="xsd:anyURI"/>
                                <xf:bind nodeset="@xml:lang"/>
                                <xf:bind nodeset="@pref" type="xsd:boolean"/>
                                <xf:bind nodeset="@refid"/>
                                <xf:bind nodeset="@rules"/>
                                <xf:bind nodeset="@source"/>
                                <xf:bind nodeset="@vocab"/>
                            -->
                        </xf:bind>
                        <xf:bind nodeset="vra:agent">
                            <xf:bind nodeset="vra:name" required="true()">
                                <xf:bind nodeset="@type" type="vra:agentNameTypeType"/>
                                <xf:bind nodeset="@pref" type="xsd:boolean"/>
                                <!--
                                    relevant="boolean-from-string(instance('i-attribute-list')/name/type/@visible)"/>
                                    <xf:bind nodeset="@dataDate" type="vra:dateValueType" relevant="boolean-from-string(instance('i-attribute-list')/name/dataDate/@visible)"/>
                                    <xf:bind nodeset="@extent" relevant="boolean-from-string(instance('i-attribute-list')/name/extent/@visible)"/>
                                    <xf:bind nodeset="@href" type="xsd:anyURI" relevant="boolean-from-string(instance('i-attribute-list')/name/href/@visible)"/>
                                    <xf:bind nodeset="@xml:lang" relevant="boolean-from-string(instance('i-attribute-list')/name/lang/@visible)"/>
                                    <xf:bind nodeset="@pref" type="xsd:boolean" relevant="boolean-from-string(instance('i-attribute-list')/name/pref/@visible)"/>
                                    <xf:bind nodeset="@refid" relevant="boolean-from-string(instance('i-attribute-list')/name/refid/@visible)"/>
                                    <xf:bind nodeset="@rules" relevant="boolean-from-string(instance('i-attribute-list')/name/rules/@visible)"/>
                                    <xf:bind nodeset="@source" relevant="boolean-from-string(instance('i-attribute-list')/name/source/@visible)"/>
                                    <xf:bind nodeset="@vocab" relevant="boolean-from-string(instance('i-attribute-list')/name/vocab/@visible)"/>
                                    <xf:bind nodeset="@script" relevant="boolean-from-string(instance('i-attribute-list')/name/script/@visible)"/>
                                    <xf:bind nodeset="@transliteration" relevant="boolean-from-string(instance('i-attribute-list')/name/transliteration/@visible)"/>
                                -->
                            </xf:bind>
                            <xf:bind nodeset="vra:culture">
                                <xf:bind nodeset="@pref" type="xsd:boolean"/>
                                <!--
                                    <xf:bind nodeset="vra:culture">
                                        <xf:bind nodeset="@dataDate" type="vra:dateValueType" relevant="boolean-from-string(instance('i-attribute-list')/culture/dataDate/@visible)"/>
                                        <xf:bind nodeset="@extent" relevant="boolean-from-string(instance('i-attribute-list')/culture/extent/@visible)"/>
                                        <xf:bind nodeset="@href" type="xsd:anyURI" relevant="boolean-from-string(instance('i-attribute-list')/culture/href/@visible)"/>
                                        <xf:bind nodeset="@xml:lang" relevant="boolean-from-string(instance('i-attribute-list')/culture/lang/@visible)"/>
                                        <xf:bind nodeset="@pref" type="xsd:boolean" relevant="boolean-from-string(instance('i-attribute-list')/culture/pref/@visible)"/>
                                        <xf:bind nodeset="@refid" relevant="boolean-from-string(instance('i-attribute-list')/culture/refid/@visible)"/>
                                        <xf:bind nodeset="@rules" relevant="boolean-from-string(instance('i-attribute-list')/culture/rules/@visible)"/>
                                        <xf:bind nodeset="@source" relevant="boolean-from-string(instance('i-attribute-list')/culture/source/@visible)"/>
                                        <xf:bind nodeset="@vocab" relevant="boolean-from-string(instance('i-attribute-list')/culture/vocab/@visible)"/>
                                        <xf:bind nodeset="@script" relevant="boolean-from-string(instance('i-attribute-list')/culture/script/@visible)"/>
                                        <xf:bind nodeset="@transliteration" relevant="boolean-from-string(instance('i-attribute-list')/culture/transliteration/@visible)"/>
                                -->
                            </xf:bind>
                            <xf:bind nodeset="vra:role">
                                <xf:bind nodeset="@pref" type="xsd:boolean"/>
                                <!--
                                    <xf:bind nodeset="@dataDate" type="vra:dateValueType" relevant="boolean-from-string(instance('i-attribute-list')/role/dataDate/@visible)"/>
                                    <xf:bind nodeset="@extent" relevant="boolean-from-string(instance('i-attribute-list')/role/extent/@visible)"/>
                                    <xf:bind nodeset="@href" type="xsd:anyURI" relevant="boolean-from-string(instance('i-attribute-list')/role/href/@visible)"/>
                                    <xf:bind nodeset="@xml:lang" relevant="boolean-from-string(instance('i-attribute-list')/role/lang/@visible)"/>
                                    <xf:bind nodeset="@pref" type="xsd:boolean" relevant="boolean-from-string(instance('i-attribute-list')/role/pref/@visible)"/>
                                    <xf:bind nodeset="@refid" relevant="boolean-from-string(instance('i-attribute-list')/role/refid/@visible)"/>
                                    <xf:bind nodeset="@rules" relevant="boolean-from-string(instance('i-attribute-list')/role/rules/@visible)"/>
                                    <xf:bind nodeset="@source" relevant="boolean-from-string(instance('i-attribute-list')/role/source/@visible)"/>
                                    <xf:bind nodeset="@vocab" relevant="boolean-from-string(instance('i-attribute-list')/role/vocab/@visible)"/>
                                    <xf:bind nodeset="@script" relevant="boolean-from-string(instance('i-attribute-list')/role/script/@visible)"/>
                                    <xf:bind nodeset="@transliteration" relevant="boolean-from-string(instance('i-attribute-list')/role/transliteration/@visible)"/>
                                -->
                            </xf:bind>
                            <xf:bind nodeset="vra:attribution">
                                <xf:bind nodeset="@pref" type="xsd:boolean"/>
                                <!--
                                    <xf:bind nodeset="vra:attribution">
                                    <xf:bind nodeset="@dataDate" type="vra:dateValueType" relevant="boolean-from-string(instance('i-attribute-list')/attribution/dataDate/@visible)"/>
                                    <xf:bind nodeset="@extent" relevant="boolean-from-string(instance('i-attribute-list')/attribution/extent/@visible)"/>
                                    <xf:bind nodeset="@href" type="xsd:anyURI" relevant="boolean-from-string(instance('i-attribute-list')/attribution/href/@visible)"/>
                                    <xf:bind nodeset="@xml:lang" relevant="boolean-from-string(instance('i-attribute-list')/attribution/lang/@visible)"/>
                                    <xf:bind nodeset="@pref" type="xsd:boolean" relevant="boolean-from-string(instance('i-attribute-list')/attribution/pref/@visible)"/>
                                    <xf:bind nodeset="@refid" relevant="boolean-from-string(instance('i-attribute-list')/attribution/refid/@visible)"/>
                                    <xf:bind nodeset="@rules" relevant="boolean-from-string(instance('i-attribute-list')/attribution/rules/@visible)"/>
                                    <xf:bind nodeset="@source" relevant="boolean-from-string(instance('i-attribute-list')/attribution/source/@visible)"/>
                                    <xf:bind nodeset="@vocab" relevant="boolean-from-string(instance('i-attribute-list')/attribution/vocab/@visible)"/>
                                    <xf:bind nodeset="@script" relevant="boolean-from-string(instance('i-attribute-list')/attribution/script/@visible)"/>
                                    <xf:bind nodeset="@transliteration" relevant="boolean-from-string(instance('i-attribute-list')/attribution/transliteration/@visible)"/>
                                -->
                            </xf:bind>

                            <!--
                                <xf:bind nodeset="@dataDate" type="vra:dateValueType"/>
                                <xf:bind nodeset="@extent"/>
                                <xf:bind nodeset="@href" type="xsd:anyURI"/>
                                <xf:bind nodeset="@xml:lang"/>
                                <xf:bind nodeset="@pref" type="xsd:boolean"/>
                                <xf:bind nodeset="@refid"/>
                                <xf:bind nodeset="@rules"/>
                                <xf:bind nodeset="@source"/>
                                <xf:bind nodeset="@vocab"/>

                                <xf:bind nodeset="vra:dates">
                                    <xf:bind nodeset="@type" type="vra:agentDateTypeType"/>
                                    <xf:bind nodeset="vra:earliestDate">
                                        <xf:bind nodeset="@circa" type="xsd:boolean"/>
                                    </xf:bind>
                                    <xf:bind nodeset="vra:latestDate">
                                        <xf:bind nodeset="@circa" type="xsd:boolean"/>
                                    </xf:bind>
                                </xf:bind>
                            -->
                        </xf:bind>
                    </xf:bind>
                    <xf:instance id="i-templates">
                        <templates xmlns="http://www.vraweb.org/vracore4.htm">
                            <!-- todo: clarify: are agent attributes required? They are present in the schema but are they use for ziziphus? -->
                            <agent dataDate="" extent="" href="" xml:lang="" pref="" refid="" rules="" source="" vocab="" script=""
                                   transliteration="">
                                <attribution dataDate="" extent="" href="" xml:lang="" pref="" refid="" rules="" source="" vocab=""
                                             script="" transliteration=""/>
                                <culture dataDate="" extent="" href="" xml:lang="" pref="" refid="" rules="" source="" vocab="" script=""
                                         transliteration=""/>
                                <dates type="">
                                    <earliestDate circa=""/>
                                    <latestDate circa=""/>
                                </dates>
                                <name type="" pref="false" vocab="" xml:lang="" script="" dataDate="" extent="" href="" refid="" rules=""
                                      source="" transliteration=""/>
                                <role dataDate="" extent="" href="" xml:lang="" pref="" refid="" rules="" source="" vocab="" script=""
                                      transliteration=""/>
                            </agent>
                            <notes dataDate="" extent="" href="" xml:lang="" pref="" refid="" rules="" source="" vocab="" script=""
                                  transliteration=""/>
                            <display dataDate="" extent="" href="" xml:lang="" pref="" refid="" rules="" source="" vocab="" script=""
                                  transliteration=""/>
                        </templates>
                    </xf:instance>
                    <xf:instance id="i-artists-service">
                        <artists xmlns="" selected="">
                            <artist>
                                <id>500125274</id>
                                <name>Jan van Eyck</name>
                            </artist>
                            <artist>
                                <id>500125275</id>
                                <name>Albrecht Dürer</name>
                            </artist>
                            <artist>
                                <id>500125276</id>
                                <name>Raffael</name>
                            </artist>
                            <artist>
                                <id>500125277</id>
                                <name>Albrecht Altdorfer</name>
                            </artist>
                            <artist>
                                <id>500065958</id>
                                <name>Schliemann, Heinrich</name>
                            </artist>
                            <artist>
                                <id>500098958</id>
                                <name>Priya, Paul</name>
                            </artist>
                            <artist>
                                <id>500023958</id>
                                <name>Paul, Surrendra</name>
                            </artist>
                        </artists>
                    </xf:instance>
                    <!--
                        <xf:instance id="i-attribute-list">
                            <data xmlns="">
                                <name>
                                    <type visible="true">type</type>
                                    <dataDate visible="false">dataDate</dataDate>
                                    <extent visible="false">extent</extent>
                                    <href visible="false">href</href>
                                    <pref visible="true">pref</pref>
                                    <refid visible="false">refid</refid>
                                    <rules visible="false">rules</rules>
                                    <source visible="false">source</source>
                                    <vocab visible="true">vocab</vocab>
                                    <lang visible="true">lang</lang>
                                    <script visible="true">script</script>
                                    <transliteration visible="false">transliteration</transliteration>
                                </name>
                                <culture>
                                    <dataDate visible="false"/>
                                    <extent visible="false"/>
                                    <href visible="true"/>
                                    <pref visible="false"/>
                                    <refid visible="false"/>
                                    <rules visible="false"/>
                                    <source visible="true"/>
                                    <vocab visible="false"/>
                                    <lang visible="true"/>
                                    <script visible="true"/>
                                    <transliteration visible="false"/>
                                </culture>
                                <role>
                                    <dataDate visible="false"/>
                                    <extent visible="false"/>
                                    <href visible="false"/>
                                    <pref visible="false"/>
                                    <refid visible="true"/>
                                    <rules visible="false"/>
                                    <source visible="false"/>
                                    <vocab visible="true"/>
                                    <lang visible="false"/>
                                    <script visible="false"/>
                                    <transliteration visible="false"/>
                                </role>
                                <attribution>
                                    <dataDate visible="false"/>
                                    <extent visible="false"/>
                                    <href visible="false"/>
                                    <pref visible="false"/>
                                    <refid visible="false"/>
                                    <rules visible="false"/>
                                    <source visible="false"/>
                                    <vocab visible="false"/>
                                    <lang visible="true"/>
                                    <script visible="true"/>
                                    <transliteration visible="false"/>
                                </attribution>
                            </data>
                        </xf:instance>
                    -->
                    <xf:instance id="i-agentSetController">
                        <data xmlns="">
                            <showNotesDisplay>false</showNotesDisplay>
                            <!-- Attribute handling -->
                            <elementName/>
                            <attribute/>
                            <attributes dataDate="" extent="" href="" xml:lang="" pref="" refid="" rules="" source="" vocab="" script="" transliteration=""/>
                        </data>
                    </xf:instance>
                    <xf:bind nodeset="instance('i-agentSetController')/showNotesDisplay" relevant="boolean-from-string(.)"/>

                    <xf:submission id="s-load-data" resource="records?_query=//*[@id='{$recordId}']/*:agentSet&amp;_wrap=no"
                                   replace="instance" instance="i-agentSet" method="get" serialize="false" validate="false">
                        <xf:message ev:event="xforms-submit-error">Could not load AgentSet data</xf:message>
                    </xf:submission>

                    <xf:submission id="s-save-data" resource="modules/save2section.xql?id={bf:appContext('recordId')}&amp;section=agentSet"
                                   replace="none" ref="instance('i-agentSet')" method="post" validate="false">
                        <xf:message ev:event="xforms-submit-error">Could not save AgentSet data</xf:message>
                        <xf:send ev:event="xforms-submit-done" submission="s-update-tracklog"/>
                        <xf:send ev:event="xforms-submit-done" submission="s-embed-w-html" if="bf:appContext('record') = 'work'"/>
                        <xf:send ev:event="xforms-submit-done" submission="s-embed-i-html" if="bf:appContext('record') = 'image'"/>
                    </xf:submission>

                    <xf:submission id="s-update-tracklog" resource="modules/tracklog.xql?id={bf:appContext('recordId')}&amp;section=agentSet"
                                   replace="none" ref="instance('i-agentSet')" method="post" validate="false">
                        <xf:message ev:event="xforms-submit-error">Could not update AgentSet tracklog</xf:message>
                    </xf:submission>

                    <xf:submission id="s-embed-w-html" ref="instance('i-agentSet')" replace="embedHTML" targetid="w_Agent_HtmlContent"
                                   resource="xslt:resources/xsl/vraSets/AgentSet.xsl?parseString=false" method="get" validate="false">
                        <xf:message ev:event="xforms-submit-error">Could not embed AgentSet data</xf:message>
                        <xf:action ev:event="xforms-submit-done">
                            <xf:toggle case="c-w_Agent-view" model="model-1"/>
                            <xf:setvalue ref="instance('i-control-center')/currentform" value="''" model="model-1"/>
                        </xf:action>
                    </xf:submission>

                    <xf:submission id="s-embed-i-html" ref="instance('i-agentSet')" replace="embedHTML" targetid="i_Agent_HtmlContent"
                                   resource="xslt:resources/xsl/vraSets/AgentSet.xsl?parseString=false" method="get" validate="false">
                        <xf:message ev:event="xforms-submit-error">Could not embed AgentSet data</xf:message>
                        <xf:action ev:event="xforms-submit-done">
                            <xf:toggle case="c-i_Agent-view" model="model-1"/>
                            <xf:setvalue ref="instance('i-control-center')/currentform" value="''" model="model-1"/>
                        </xf:action>
                    </xf:submission>
                    <xf:action ev:event="xforms-ready">
                        <xf:send submission="s-load-data"/>
                    </xf:action>
                </xf:model>
            </div>

            <!-- todo: clarify - what do these elements do ????????????? -->
            <div style="display:none">
                <!-- close attribute dialog -->
                <xf:output ref="instance('i-agentSetController')/attribute">
                    <xf:label>Attribute</xf:label>
                    <xf:action ev:event="xforms-value-changed">
                        <xf:insert context="instance('i-agentSet')/vra:agent[index('r-vraAgent')]/*[local-name() eq instance('i-agentSetController')/elementName]" origin="instance('i-templates')/vra:agent/*[local-name() eq instance('i-agentSetController')/elementName]/@*[local-name() eq instance('i-agentSetController')/attribute]" />
                        <xf:setvalue ref="instance('i-agentSetController')/elementName" />
                    </xf:action>
                </xf:output>

                <!-- open attribute dialog -->
                <xf:output ref="instance('i-agentSetController')/elementName">
                    <xf:label>ElementName</xf:label>

                    <xf:action ev:event="xforms-value-changed" if="not(instance('i-agentSetController')/elementName eq '')" >
                        <xf:insert context="instance('i-agentSetController')/attributes" origin="instance('i-templates')/vra:agent/*[local-name() eq instance('i-agentSetController')/elementName]/@*[not(some $item in instance('i-agentSet')/vra:agent/*[local-name() eq instance('i-agentSetController')/elementName]/@* satisfies ($item/local-name()) eq local-name(.))]" />
                        <xf:dispatch targetid="t-show-dialog" name="DOMActivate"/>
                    </xf:action>
                </xf:output>

                <xf:trigger id="t-show-dialog">
                    <xf:label>A label</xf:label>
                    <bfc:show dialog="attrDialog" ev:event="DOMActivate"/>
                </xf:trigger>
            </div>

            <!-- ####################################### VISIBLE UI ####################################### -->
            <!-- ####################################### VISIBLE UI ####################################### -->
            <!-- ####################################### VISIBLE UI ####################################### -->
            <xf:group appearance="minimal" ref="instance('i-agentSet')" model="m-child-model">
                <xf:label/>
                <xf:trigger class="t-save" model="m-child-model" title="Save">
                    <xf:label/>
                    <xf:send submission="s-save-data"/>
                </xf:trigger>
                <div>
                    <xf:trigger class="t-plus" model="m-child-model" title="Add Agent">
                        <xf:label/>
                        <xf:insert nodeset="instance()/vra:agent[last()]" origin="instance('i-templates')/vra:agent"
                                   model="m-child-model"/>
                    </xf:trigger>
                    <xf:trigger class="t-minus" model="m-child-model" title="Delete Agent">
                        <xf:label/>
                        <xf:delete nodeset="instance()/vra:agent" at="index('r-vraAgent')" model="m-child-model"/>
                    </xf:trigger>
                </div>



                <!-- display and notes -->
                <!-- TBD
                <bfc:dialog id="attrDialog2">
                    <xf:label>Attribute Dialog</xf:label>
                    <xf:select1
                            ref="instance('i-agentSet')/*[local-name() eq instance('i-agentSetController')/elementName]">
                        <xf:label>Add Attribute</xf:label>
                        <xf:itemset
                                nodeset="instance('i-templates')/*[local-name() eq instance('i-agentSetController')/elementName]/@*[not(some $item in instance('i-agentSet')/*[local-name() eq instance('i-agentSetController')/elementName]/@* satisfies ($item/local-name()) eq local-name(.))]">
                            <xf:label>
                                <xf:output value="local-name(.)"/>
                            </xf:label>
                            <xf:copy ref="."/>
                            <bfc:hide dialog="attrDialog2" ev:event="xforms-select"/>
                        </xf:itemset>
                    </xf:select1>
                </bfc:dialog>
                -->
                <table class="table table-condensed">
                    <thead>
                        <tr>
                            <th>Pref</th>
                            <th>Role</th>
                            <th>Name</th>
                            <th class="detail">Vocab</th>
                            <td/>
                        </tr>
                    </thead>
                    <tbody  id="r-vraAgent" xf:repeat-nodeset="vra:agent" model="m-child-model">
                        <!-- todo: does the agent shall not have attributes??? -->
                        <!-- todo: clarify: do we need agent attributes ??? -->
                        <!--
                            <div class="agentSet-agent-attributes hiddenAttributes" style="display:none;">
                                <xf:input ref="./@dataDate" model="m-child-model">
                                    <xf:label>dataDate</xf:label>
                                </xf:input>
                                <xf:input ref="./@extent" model="m-child-model">
                                    <xf:label>extent</xf:label>
                                </xf:input>
                                <xf:input ref="./@href" model="m-child-model">
                                    <xf:label>href</xf:label>
                                </xf:input>
                                <xf:input ref="./@xml:lang" model="m-child-model">
                                    <xf:label>lang</xf:label>
                                </xf:input>
                                <xf:input ref="./@pref" model="m-child-model">
                                    <xf:label>pref</xf:label>
                                </xf:input>
                                <xf:input ref="./@refid" model="m-child-model">
                                    <xf:label>refid</xf:label>
                                </xf:input>
                                <xf:input ref="./@rules" model="m-child-model">
                                    <xf:label>rules</xf:label>
                                </xf:input>
                                <xf:input ref="./@source" model="m-child-model">
                                    <xf:label>source</xf:label>
                                </xf:input>
                                <xf:input ref="./@vocab" model="m-child-model">
                                    <xf:label>vocab</xf:label>
                                </xf:input>
                            </div>
                        -->

                        <tr>
                                <td>
                                    <xf:input ref="vra:name/@pref">
                                        <xf:label>pref</xf:label>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:select1 ref="vra:name/@type">
                                        <xf:label>Type</xf:label>
                                        <xf:item>
                                            <xf:label>Personal</xf:label>
                                            <xf:value>personal</xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>Corporate</xf:label>
                                            <xf:value>corporate</xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>Family</xf:label>
                                            <xf:value>family</xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>Other</xf:label>
                                            <xf:value>other</xf:value>
                                        </xf:item>
                                    </xf:select1>
                                </td>
                                <td>
                                    <xf:input ref="vra:name" type="nodeValue" class="elementName">
                                        <xf:label>Name</xf:label>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:select1 ref="vra:name/@vocab">
                                        <xf:label>vocab</xf:label>
                                        <xf:item>
                                            <xf:label>ULAN</xf:label>
                                            <xf:value>ULAN</xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>GND</xf:label>
                                            <xf:value>GND</xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>(AKL)</xf:label>
                                            <xf:value>(AKL)</xf:value>
                                        </xf:item>
                                    </xf:select1>
                                </td>
                                <td>
                                    <xf:trigger>
                                        <xf:label>x</xf:label>
                                        <xf:delete nodeset="."/>
                                    </xf:trigger>
                                </td>
                            </tr>
                    </tbody>
                </table>


                <!-- ############################## NOTES ####################################### -->
                <!-- ############################## NOTES ####################################### -->
                <!-- ############################## NOTES ####################################### -->
                <xf:group class="showNotesDisplay">
                    <xf:trigger class="notesDisplayTrigger">
                        <xf:label>Show/Hide Notes and Display</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/showNotesDisplay"
                                     value="not(boolean-from-string(instance('i-agentSetController')/showNotesDisplay))"/>
                    </xf:trigger>
                    <xf:group ref="instance('i-agentSetController')/showNotesDisplay">
                        <xf:group appearance="minimal" class="elementGroup" ref="instance('i-agentSet')">
                            <xf:label/>
                                <xf:group class="attributeGroup" appearance="minimal">
                                    <xf:label/>
                                <xf:textarea ref="vra:display" type="nodeValue" model="m-child-model">
                                    <xf:label>Display:</xf:label>
                                </xf:textarea>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@xml:lang" model="m-child-model">
                                    <xf:label>lang</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@script" model="m-child-model">
                                    <xf:label>script</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@dataDate" model="m-child-model">
                                    <xf:label>dataDate</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@extent" model="m-child-model">
                                    <xf:label>extent</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@href" model="m-child-model">
                                    <xf:label>href</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@pref" model="m-child-model">
                                    <xf:label>pref</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@refid" model="m-child-model">
                                    <xf:label>refid</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@rules" model="m-child-model">
                                    <xf:label>rules</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@source" model="m-child-model">
                                    <xf:label>source</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>

                                <!-- TODO: connect service -->
                                <xf:select1 ref="vra:display/@vocab" model="m-child-model">
                                    <!--  <xf:label/> -->
                                    <xf:label>vocab</xf:label>
                                    <xf:item>
                                        <xf:label>Gimme</xf:label>
                                        <xf:value>Gimme</xf:value>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>,gimme</xf:label>
                                        <xf:value>,gimme</xf:value>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>data</xf:label>
                                        <xf:value>data</xf:value>
                                    </xf:item>
                                </xf:select1>

                                <!--
                                    <xf:input ref="vra:display/@vocab" model="m-child-model">
                                        <xf:label>vocab</xf:label>
                                    </xf:input>
                                -->
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:display/@transliteration" model="m-child-model">
                                    <xf:label>transliteration</xf:label>
                                </xf:input>
                            </xf:group>
                            <!--
                               <xf:trigger class="attributeTrigger">
                                    <xf:label>Remove/Add Attribute</xf:label>
                                    <xf:setvalue ref="instance('i-agentSetController')/elementName" value="''"/>
                                    <xf:delete nodeset="instance('i-agentSetController')/attributes/@*"/>
                                    <xf:setvalue ref="instance('i-agentSetController')/elementName" value="'display'"/>
                                </xf:trigger>
                            -->
                        </xf:group>
                        <xf:group appearance="minimal" class="elementGroup" ref="instance('i-agentSet')">
                            <xf:label/>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:textarea ref="vra:notes" type="nodeValue" model="m-child-model">
                                    <xf:label>Notes</xf:label>
                                </xf:textarea>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@xml:lang" model="m-child-model">
                                    <xf:label>lang</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@script" model="m-child-model">
                                    <xf:label>script</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@dataDate" model="m-child-model">
                                    <xf:label>dataDate</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@extent" model="m-child-model">
                                    <xf:label>extent</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@href" model="m-child-model">
                                    <xf:label>href</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@pref" model="m-child-model">
                                    <xf:label>pref</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@refid" model="m-child-model">
                                    <xf:label>refid</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@rules" model="m-child-model">
                                    <xf:label>rules</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@source" model="m-child-model">
                                    <xf:label>source</xf:label>
                                </xf:input>
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>

                                <!-- TODO: connect service -->
                                <xf:select1 ref="vra:notes/@vocab" model="m-child-model">
                                    <!--  <xf:label/> -->
                                    <xf:label>vocab</xf:label>
                                    <xf:item>
                                        <xf:label>Gimme</xf:label>
                                        <xf:value>Gimme</xf:value>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>,gimme</xf:label>
                                        <xf:value>,gimme</xf:value>
                                    </xf:item>
                                    <xf:item>
                                        <xf:label>data</xf:label>
                                        <xf:value>data</xf:value>
                                    </xf:item>
                                </xf:select1>

                                <!--
                                    <xf:input ref="vra:notes/@vocab" model="m-child-model">
                                        <xf:label>vocab</xf:label>
                                    </xf:input>
                                -->
                            </xf:group>
                            <xf:group class="attributeGroup" appearance="minimal">
                                <xf:label/>
                                <xf:input ref="vra:notes/@transliteration" model="m-child-model">
                                    <xf:label>transliteration</xf:label>
                                </xf:input>
                            </xf:group>
                            <!-- TDB
                                <xf:trigger class="attributeTrigger">
                                    <xf:label>Remove/Add Attribute</xf:label>
                                    <xf:setvalue ref="instance('i-agentSetController')/elementName" value="''"/>
                                    <xf:delete nodeset="instance('i-agentSetController')/attributes/@*"/>
                                    <xf:setvalue ref="instance('i-agentSetController')/elementName" value="'notes'"/>
                                </xf:trigger>
                            -->
                        </xf:group>
                    </xf:group>
                </xf:group>
            </xf:group>

            <!-- todo: does not add/remove elements right? -->
            <!-- ################### Dialog for adding/removing attributes subelements name/role/culture/... -->
            <bfc:dialog id="attrDialog">
                <xf:label>Remove/Add Attribute</xf:label>
                <xf:group ref="instance('i-agentSet')/vra:agent[index('r-vraAgent')]/*[local-name() eq instance('i-agentSetController')/elementName]">
                    <xf:label>Remove Attribute</xf:label>

                    <xf:trigger ref="@dataDate">
                        <xf:label>dataDate</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@extent">
                        <xf:label>extent</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@href">
                        <xf:label>href</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@xml:lang">
                        <xf:label>lang</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@pref">
                        <xf:label>pref</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@refid">
                        <xf:label>refid</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@rules">
                        <xf:label>rules</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@source">
                        <xf:label>source</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@vocab">
                        <xf:label>vocab</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@script">
                        <xf:label>script</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@transliteration">
                        <xf:label>transliteration</xf:label>
                        <xf:delete nodeset="."/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>
                </xf:group>

                <xf:group ref="instance('i-agentSetController')/attributes">
                    <xf:label>Add Attribute</xf:label>

                    <xf:trigger ref="@dataDate">
                        <xf:label>dataDate</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'dataDate'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@extent">
                        <xf:label>extent</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'extent'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@href">
                        <xf:label>href</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'href'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@xml:lang">
                        <xf:label>lang</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'lang'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@pref">
                        <xf:label>pref</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'pref'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@refid">
                        <xf:label>refid</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'refid'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@rules">
                        <xf:label>rules</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'rules'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@source">
                        <xf:label>source</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'source'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@vocab">
                        <xf:label>vocab</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'vocab'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@script">
                        <xf:label>script</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'script'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>

                    <xf:trigger ref="@transliteration">
                        <xf:label>transliteration</xf:label>
                        <xf:setvalue ref="instance('i-agentSetController')/attribute" value="'transliteration'"/>
                        <bfc:hide dialog="attrDialog" ev:event="DOMActivate"/>
                    </xf:trigger>
                </xf:group>
            </bfc:dialog>

        </div>
    </body>
</html>

