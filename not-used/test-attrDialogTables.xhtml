<?xml version="1.0" encoding="UTF-8"?>
<html xmlns:vra="http://www.vraweb.org/vracore4.htm"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xsd="http://www.w3.org/2001/XMLSchema"
      xmlns:xf="http://www.w3.org/2002/xforms"
      xmlns:ev="http://www.w3.org/2001/xml-events"
      xmlns:bfc="http://betterform.sourceforge.net/xforms/controls">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>Ziziphus_Image_DB</title>
        <link rel="stylesheet" type="text/css" href="../resources/css/bootstrap.min.css"/>

        <style type="text/css">
            #xforms .vraSet, #xforms .vraSetElement, #xforms .vraComplex {
                margin: 10px;
                display: block !important;
                width: 90%;
            }
            body #xforms .xfLabel{
                display: none;
            }
            body #xforms .vraSet .xfTrigger {
                float: right;
                border: none;
                width: 20px;
            }

            body #xforms .xfTrigger .xfValue {
                border: none;
                float: left;
                width: 15px;
                height: 15px;
            }
        </style>
    </head>
    <body>
        <div id="xforms">
            <div style="display:none">
                <xf:model id="child-model" schema="../resources/xsd/vra-types.xsd">
                    <xf:instance id="i-agentSet">
                        <agentSet xmlns="http://www.vraweb.org/vracore4.htm">
                            <agent>
                                <attribution pref="true" source="baba"></attribution>
                                <culture></culture>
                                <dates type="" pref="true" refid="bubu">
                                    <earliestDate circa="false"></earliestDate>
                                    <latestDate circa="false"></latestDate>
                                </dates>
                                <name type="" pref="false"></name>
                                <role></role>
                            </agent>
                        </agentSet>
                    </xf:instance>
                    <xf:bind nodeset="instance()">
                        <xf:bind nodeset="vra:agent">
                            <xf:bind nodeset="@pref" type="xf:boolean"/>
                            <xf:bind nodeset="vra:attribution"></xf:bind>
                            <xf:bind nodeset="vra:culture"></xf:bind>
                            <xf:bind nodeset="vra:dates">
                                <xf:bind nodeset="@type" type="vra:agentDateTypeType"></xf:bind>
                                <xf:bind nodeset="vra:earliestDate">
                                    <xf:bind nodeset="@circa" type="xsd:boolean"></xf:bind>
                                </xf:bind>
                                <xf:bind nodeset="vra:latestDate">
                                    <xf:bind nodeset="@circa" type="xsd:boolean"></xf:bind>
                                </xf:bind>
                            </xf:bind>
                            <xf:bind nodeset="vra:name">
                                <xf:bind nodeset="@type" type="vra:agentNameTypeType"></xf:bind>
                            </xf:bind>
                            <xf:bind nodeset="vra:role"></xf:bind>
                        </xf:bind>
                    </xf:bind>

                    <xf:instance id="i-attributes">
                        <data xmlns="http://www.vraweb.org/vracore4.htm">
                            <vraElement
                                    dataDate=""
                                    extent=""
                                    href=""
                                    pref="false"
                                    refid=""
                                    rules=""
                                    source=""
                                    vocab=""/>
                        </data>
                    </xf:instance>
                    <xf:bind nodeset="instance('i-attributes')/*[1]">
                        <xf:bind nodeset="@dataDate" type="vra:dateValueType"/>
                        <xf:bind nodeset="@href" type="xsd:anyURI"/>
                        <xf:bind nodeset="@pref" type="xsd:boolean"/>
                    </xf:bind>

                    <xf:instance id="i-util">
                        <data xmlns="">
                            <currentElement/>
                        </data>
                    </xf:instance>
                </xf:model>
            </div>
            <h1>Tables for Elements with Attributedialog</h1>
            <xf:group ref="instance()" appearance="minimal" class="vraSet" model="child-model">
                <xf:label>AgentSet</xf:label>

                <xf:group id="r-agentSet" class="vraSetElement" ref="vra:agent" appearance="full">
                    <xf:label>Agent</xf:label>

                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <td>Attibution</td>
                                <td/>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <xf:input class="elementInSet" ref="vra:attribution" type="nodeValue">
                                        <xf:label/>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:trigger class="-icon-tasks">
                                        <xf:label></xf:label>
                                        <xf:action>
                                            <xf:setvalue ref="instance('i-util')/currentElement" value="'attribution'"/>
                                            <!-- copy existing values from payload instance to i-attributes -->
                                            <xf:insert context="instance('i-attributes')/vra:vraElement[1]"
                                                       origin="instance('i-agentSet')/vra:agent/vra:attribution/@*"/>
                                        </xf:action>
                                        <bfc:show dialog="attrDialog" ev:event="DOMActivate"/>
                                    </xf:trigger>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="attribution-mount"/>


                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <td>Culture</td>
                                <td/>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <xf:input class="elementInSet" ref="vra:culture" type="nodeValue">
                                        <xf:label/>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:trigger class="-icon-tasks">
                                        <xf:label></xf:label>
                                        <xf:action>
                                            <xf:setvalue ref="instance('i-util')/currentElement" value="'culture'"/>
                                            <!-- copy existing values from payload instance to i-attributes -->
                                            <xf:insert context="instance('i-attributes')/vra:vraElement[1]"
                                                       origin="instance('i-agentSet')/vra:agent/vra:culture/@*"/>
                                        </xf:action>
                                        <bfc:show dialog="attrDialog" ev:event="DOMActivate"/>
                                    </xf:trigger>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="culture-mount"/>

                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <td>Dates</td>
                                <td>earliest</td>
                                <td>circa</td>
                                <td>latest</td>
                                <td>circa</td>
                                <td/>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <xf:input class="elementInSet" ref="vra:dates/@type" type="nodeValue" model="child-model">
                                        <xf:label/>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:input class="elementInSet" ref="vra:dates/vra:earliestDate" type="nodeValue" model="child-model">
                                        <xf:label></xf:label>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:input ref="vra:dates/vra:earliestDate/@circa">
                                        <xf:label/>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:input ref="vra:dates/vra:latestDate" type="nodeValue" model="child-model">
                                        <xf:label></xf:label>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:input ref="vra:dates/vra:latestDate/@circa">
                                        <xf:label/>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:trigger class="-icon-tasks">
                                        <xf:label></xf:label>
                                        <xf:action>
                                            <xf:setvalue ref="instance('i-util')/currentElement" value="'dates'"/>
                                            <!-- copy existing values from payload instance to i-attributes -->
                                            <xf:insert context="instance('i-attributes')/vra:vraElement[1]"
                                                       origin="instance('i-agentSet')/vra:agent/vra:dates/@*"/>
                                        </xf:action>
                                        <bfc:show dialog="attrDialog" ev:event="DOMActivate"/>
                                    </xf:trigger>
                                </td>
                            </tr>
                        </tbody>
                    </table>


                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <td>Type</td>
                                <td>Name</td>
                                <td/>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <xf:input class="elementInSet" ref="vra:name/@type" type="nodeValue" model="child-model">
                                        <xf:label/>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:input class="elementInSet" ref="vra:name" type="nodeValue" model="child-model">
                                        <xf:label></xf:label>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:trigger class="-icon-tasks">
                                        <xf:label></xf:label>
                                        <xf:action>
                                            <xf:setvalue ref="instance('i-util')/currentElement" value="'name'"/>
                                            <!-- copy existing values from payload instance to i-attributes -->
                                            <xf:insert context="instance('i-attributes')/vra:vraElement[1]"
                                                       origin="instance('i-agentSet')/vra:agent/vra:name/@*"/>
                                        </xf:action>
                                        <bfc:show dialog="attrDialog" ev:event="DOMActivate"/>
                                    </xf:trigger>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <td>Role</td>
                                <td/>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <xf:input class="elementInSet" ref="vra:role" type="nodeValue" model="child-model">
                                        <xf:label/>
                                    </xf:input>
                                </td>
                                <td>
                                    <xf:trigger class="-icon-tasks">
                                        <xf:label></xf:label>
                                        <xf:action>
                                            <xf:setvalue ref="instance('i-util')/currentElement" value="'role'"/>
                                            <!-- copy existing values from payload instance to i-attributes -->
                                            <xf:insert context="instance('i-attributes')/vra:vraElement[1]"
                                                       origin="instance('i-agentSet')/vra:agent/vra:role/@*"/>
                                        </xf:action>
                                        <bfc:show dialog="attrDialog" ev:event="DOMActivate"/>
                                    </xf:trigger>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </xf:group>
            </xf:group>


            <bfc:dialog id="attrDialog">
                <xf:label>Attributes</xf:label>
                <xf:group appearance="full" ref="instance('i-attributes')/vra:vraElement">
                    <xf:label/>
                    <xf:input ref="@dataDate">
                        <xf:label>dataDate</xf:label>
                    </xf:input>
                    <xf:input ref="@extent">
                        <xf:label>extent</xf:label>
                    </xf:input>
                    <xf:input ref="@href">
                        <xf:label>href</xf:label>
                    </xf:input>
                    <xf:input ref="@pref">
                        <xf:label>pref</xf:label>
                    </xf:input>
                    <xf:input ref="@refid">
                        <xf:label>refid</xf:label>
                    </xf:input>
                    <xf:input ref="@rules">
                        <xf:label>rules</xf:label>
                    </xf:input>
                    <xf:input ref="@source">
                        <xf:label>source</xf:label>
                    </xf:input>
                    <xf:select1 ref="@vocab">
                        <xf:label>vocab</xf:label>
                        <xf:item>
                            <xf:label>Gimme</xf:label>
                            <xf:value>Gimme</xf:value>
                        </xf:item>
                        <xf:item>
                            <xf:label>,gimme</xf:label>
                            <xf:value>,gimme</xf:value>
                        </xf:item>
                        <xf:item>
                            <xf:label>data</xf:label>
                            <xf:value>data</xf:value>
                        </xf:item>
                    </xf:select1>
                </xf:group>
                <xf:group appearance="minimal">
                    <xf:trigger>
                        <xf:label>Ok</xf:label>
                        <xf:action>
                            <!--
                                                        <xf:insert context="instance('i-attributes')/vra:vraElement[1]"
                                                                   origin="instance('i-agentSet')/vra:agent/vra:dates/@*"/>
                            -->

                            <xf:insert
                                    context="instance('i-agentSet')/vra:agent/*[local-name()=instance('i-util')/currentElement]"
                                    origin="instance('i-attributes')/vra:vraElement[1]/@*[string-length(.) != 0]"/>

                        </xf:action>
                        <bfc:hide dialog="attrDialog"></bfc:hide>
                    </xf:trigger>
                    <xf:trigger appearance="minimal">
                        <xf:label>Cancel</xf:label>
                        <bfc:hide dialog="attrDialog"></bfc:hide>
                    </xf:trigger>

                </xf:group>
            </bfc:dialog>
        </div>
    </body>
</html>